<!-- Product Report Tab - KORRIGIERTE VERSION -->
<?php 
// Daten aus Parser holen
$productReport = $parser->generateProductReport();
$productPerformance = $productReport['product_performance'] ?? [];
?>

<?php if (!empty($productPerformance)): ?>
<div class="tab-pane fade" id="product" role="tabpanel">
    <h3>Produkt-Report</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Produkt</th>
                <th>Verkaufte Stück</th>
                <th>Umsatz</th>
                <th>Durchschnittspreis</th>
                <th>Performance Score</th>
            </tr>
        </thead>
        <tbody>
            <?php foreach ($productPerformance as $product): ?>
                <tr>
                    <td><?= $this->escapeHtml($product['name'] ?? 'Unbekannt') ?></td>
                    <td><?= number_format($product['total_quantity_sold'] ?? 0, 0, ',', '.') ?></td>
                    <td><?= number_format($product['total_revenue'] ?? 0, 2, ',', '.') ?> €</td>
                    <td><?= number_format($product['price'] ?? 0, 2, ',', '.') ?> €</td>
                    <td><?= number_format($product['performance_score'] ?? 0, 1, ',', '.') ?></td>
                </tr>
            <?php endforeach; ?>
        </tbody>
    </table>
    
    <!-- Zusätzliche Statistiken -->
    <div class="row mt-4">
        <div class="col-md-6">
            <h4>Kategorie-Analyse</h4>
            <table class="table table-sm">
                <thead>
                    <tr>
                        <th>Kategorie</th>
                        <th>Produkte</th>
                        <th>Umsatz</th>
                    </tr>
                </thead>
                <tbody>
                    <?php foreach ($productReport['category_analysis'] ?? [] as $category): ?>
                        <tr>
                            <td><?= $this->escapeHtml($category['category']) ?></td>
                            <td><?= $category['product_count'] ?></td>
                            <td><?= number_format($category['total_revenue'] ?? 0, 2, ',', '.') ?> €</td>
                        </tr>
                    <?php endforeach; ?>
                </tbody>
            </table>
        </div>
        <div class="col-md-6">
            <h4>Preis-Analyse</h4>
            <ul class="list-group">
                <li class="list-group-item d-flex justify-content-between">
                    <span>Durchschnittspreis:</span>
                    <span><?= number_format($productReport['price_analysis']['average_price'] ?? 0, 2, ',', '.') ?> €</span>
                </li>
                <li class="list-group-item d-flex justify-content-between">
                    <span>Niedrigster Preis:</span>
                    <span><?= number_format($productReport['price_analysis']['price_range']['min'] ?? 0, 2, ',', '.') ?> €</span>
                </li>
                <li class="list-group-item d-flex justify-content-between">
                    <span>Höchster Preis:</span>
                    <span><?= number_format($productReport['price_analysis']['price_range']['max'] ?? 0, 2, ',', '.') ?> €</span>
                </li>
            </ul>
        </div>
    </div>
</div>
<?php endif; ?>
